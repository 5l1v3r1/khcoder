<html>

	<head>
		<title>『言語研究のための統計入門』 &amp; KH Coder</title>
		<LINK REL=STYLESHEET TYPE="text/css" HREF="ve.css" TITLE="VE Style">
		<style type="text/css">
		<!--
			h4{
				color:#FFFFFF;
				background-color:
				#191970;padding: 1px 1px 1px 3px;
				width: 100%; border: 1px none white;
				font-weight:normal;}
.center_a {
	text-align: center;
}
			-->
		</style>
		<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
		<csimport user="../khc.data/Components/head.html" occur="39"></csimport>
		<csimport user="../khc.data/Components/foot.html" occur="56"></csimport>

  <script type="text/javascript">
<!--//
function links(){
linkurl=links.arguments[1];
document.write(linkurl.link(links.arguments[2] + links.arguments[0] + links.arguments[3]));
}
//--></script>


 </head>

	<body bgcolor="#FFFFFF">


  <div align="left">
   <a name="page-top"></a>
   <table bgcolor="white" border="0" cellspacing="2" cellpadding="0" width="640">
		<tr>
			<td bgcolor="white">
      <center>
							</center>
      <csobj w="643" h="134" t="Component" csref="../khc.data/Components/head.html" occur="39">
							<div align="center">
								<table border="1" cellpadding="0" cellspacing="0" width="64">
									<tr>
										<td><a href="./" title="KH Coder"><img src="img/kh_log.jpg" width="400" height="122" border="0" alt="KH Coder"></a></td>
									</tr>
								</table>
							</div>
						</csobj><br>
      <table width="638" border="0" cellspacing="0" cellpadding="0" height="27">
       <tr>
        <td width="12" bgcolor="white"><img src="img/databg2.gif" width="17" height="35" align="BOTTOM" border="0" naturalsizeflag="3"></td>
        <td bgcolor="#00006c" background="img/databg.gif" width="626"><span class="ph">
          <table border="0" cellpadding="0" cellspacing="0" width="100%">
           <tr>
            <td><span class="ph">『言語研究のための統計入門』 &amp; KH Coder</span></td>
            <td>
             <div align="right">
              <font size="+1" color="#696969">[</font> <a href="./">KH Coder</a> <font size="+1" color="#696969">]</font></div>
            </td>
           </tr>
          </table>
         </span></td>
       </tr>
      </table>
      <br>
      <div align="right">
							<table border="0" cellpadding="0" cellspacing="0" width="97%">
								<tr>
									<td>
          <ul>
											<li>はじめに											<ul>
            <li><a href="#hajime">書籍『言語研究のための統計入門』について</a><a href="#hajime"> </a>
            <li><a href="#nerai">このページのねらい――KH Coder操作方法の別解</a>
           </ul>
           <li>KH Coderで反復操作なしに処理する方法           <ul>
            <li><a href="#junbi">始める前の準備
</a>            <li><a href="#c5prac">第5章の「練習問題」（p. 136）</a>
            <li><a href="#c5st">第5章の「日本語研究」（p. 132） </a>            
            <li><a href="#c6prac">第6章の「練習問題」（p. 161）</a>            <li><a href="#c6st">第6章の「日本語実例研究」 （p. 157）</a><li><a href="#c7prac">第7章の「練習問題」（p. 192）</a>
<li><a href="#c7st">第7章の「日本語実例研究」（p. 186）</a>
<li><a href="#c8prac">第8章の「練習問題」（p. 216）</a><li><a href="#c8st">第8章の「日本語実例研究」 （p. 212）</a><li><a href="#c10">第10章の「日本語実例研究」（p. 260）</a>           </ul>
             <li>おわりに
             <ul>
                 <li><a href="#owari">別解を振り返って</a>
                 </ul>
          </ul>
         </td>
								</tr>
							</table>
							<br>
						</div>
      <div align="right">
							<table width="638" border="0" cellspacing="0" cellpadding="0" height="27">
								<tr>
									<td width="12" bgcolor="white"><img src="img/databg2.gif" width="17" height="35" align="BOTTOM" border="0" naturalsizeflag="3"></td>
									<td bgcolor="#00006c" background="img/databg.gif" width="626"><span class="ph">はじめに</span></td>
								</tr>
							</table>
							<p></p>
							<table border="0" cellpadding="0" cellspacing="0" width="97%">
        <tr>
         <td>
          <h4><a name="hajime"></a>書籍『言語研究のための統計入門』について</h4>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=khcoder-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=487424498X" style="width:120px;height:240px; margin:5px 20px 20px 5px; " scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="left"></iframe>

          <p>著者の皆さまから『<a href="http://www.amazon.co.jp/gp/product/487424498X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487424498X&linkCode=as2&tag=khcoder-22">言語研究のための統計入門</a>』をご恵与いただきました。言語学に関しては門外漢ですので大変勉強をさせていただきました。ありがとうございました。<img src="http://ir-jp.amazon-adsystem.com/e/ir?t=khcoder-22&l=as2&o=9&a=487424498X" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>
          <p>この本では、数式の利用を抑えた、平易で直感的に理解しやすい統計手法の解説を読むことができます。それに加えて、それぞれの統計手法がコーパス分析にいかに用いられてきたのかというレビューや、今後の「発展研究のヒント」があります。ここから「各手法を使えばどんなコーパス分析・研究ができるのか」というイメージを得られる点が大変魅力的です。</p>
          <p>また、それぞれの手法を使って英語データ・日本語データを分析した「実例研究」があり、「練習問題」もついています。しかも、一部を除いて、この<font color="red">「実例研究」や「練習問題」のためのデータとソフトが付属のCD-ROMに入っているので、読者が自分のPCで実際の分析を体験することができます</font>。自分で手を動かしていろいろと試みつつ、その結果を見ることで理解が深まるという側面、すなわち「実技」としての側面がデータ分析にはありますから、体験的学習を促すこの本の仕組みは素晴らしいものと思います。</p>
          <p>また、「実例研究」や「練習問題」にKH Coderをお使いくださっているのも、ツール制作者としては大変ありがたいことです。「KH Coderを出発点にしてこんな分析ができるのか」「あんな分析もできるのか」と感心しながら読ませていただきました。</p>
          <div align="right">
           <p><a href="#page-top">↑ Index ↑</a></p>
          </div>
          <h4><a name="nerai"></a>このページのねらい――KH Coder操作方法の別解</h4>
          <p>この本を拝読していて気がついたのですが、この本が執筆された当時のKH Coderには少し足りない機能があったように思います。そのこともあって、「実例研究」や「練習問題」をいざ自分のPCでやってみようとすると、1つの分析をするために、KH Coderで同じ操作を20回も30回も繰り返さなければならない場合があるようです。具体的には、「テキストファイルをプロジェクトとして登録して、前処理をして、集計結果をExcelに貼り付けて」という同じ作業を、10〜30のテキストファイルに対して反復せねばならないようです。</p>
          <p>こうした反復作業はなかなか面倒なものです。もちろん学習の一環としてはこうした反復作業を通じて、ブラックボックス化されていない、目に見える形でデータを処理するのは非常に意義深いことです。しかし、本格的な研究の中でより大規模なデータを精密に扱わねばならない状況では、もう少し効率化することが望まれるでしょう。また、とりわけ大きな問題として、「この作業が面倒なあまりKH Coderを嫌いになってしまう人がいらっしゃったらどうしよう」という懸念を感じなくもありません (^_^;) 。 
            <!-- <font color="gray">実際にこの作業をなさったのであろう著者の皆さまが、KH Coderに対してどんな印象を持たれたのかと思うと、ちょっと怖い気もします。 --></p>
          <p>そこで、勝手ながらではありますが、こうした<font color="red">20回30回という反復作業なしに、この書籍の「練習問題」や「実例研究」を行う方法</font>を以下に紹介したいと思います。繰り返し作業を避けたい読者の方への、<span class="red">KH Coder操作方法の別解</span>としてご覧いただけましたら幸いです。この別解を使えば、20〜30どころか、2000〜3000といった数のデータでもまったく同じ手数／クリック数で分析できます。もちろんデータ準備の手間や処理の待ち時間は増えますが、分析の手順はまったく同じものが使用可能です。</p>
          <div align="right">
           <p><a href="#page-top">↑ Index ↑</a></p>
          </div>
         </td>
        </tr>
       </table>
       <p></p>
       <table width="638" border="0" cellspacing="0" cellpadding="0" height="27">
        <tr>
         <td width="12" bgcolor="white"><img src="img/databg2.gif" width="17" height="35" align="BOTTOM" border="0" naturalsizeflag="3"></td>
         <td bgcolor="#00006c" background="img/databg.gif" width="626"><span class="ph">KH Coderで反復操作なしに処理する方法</span></td>
        </tr>
       </table>
       <p></p>
       <table border="0" cellpadding="0" cellspacing="0" width="97%">
        <tr>
         <td>
          <h4><a name="junbi"></a>始める前の準備</h4>
          <p>他の分析を始める前に<a href="#c5prac">第5章の「練習問題」</a>を行い、ファイルの結合＆登録の手順を確認しておかれることをお勧めいたします。</p>


<blockquote>
<p>※以下の準備はKH Coder 2.beta.25以降では不要になりました：<br><font color="gray">
下記のZipファイルをダウンロードして解凍して下さい。そして、Zip内に含まれているファイルを、kh_coder.exeと同じ場所にある「plugin」フォルダの中にコピーして下さい。<br>
<a href="http://koichi.nihon.to/psnl/tmp/kuroshio_plugin.zip">kuroshio_plugin.zip</a> (2010 12/12)</font></p>
</blockquote>


          <div align="right">
            <p><a href="#page-top">↑ Index ↑</a></p>
          </div>
          <h4><a name="c5prac" id="c5prac"></a>第5章の「練習問題」（p. 136）</h4>
          <div align="left">
           <div align="right">
            <div align="left">
             <p>■1. はじめに</p>
             <p>20個のテキストファイルを選んで分析するという練習問題ですが、KH Coderは基本的に複数ファイルの分析には対応していません。そのため、そのまま実行すると、「プロジェクトの登録→前処理→集計結果をExcelにコピー」という一連の作業を20回繰り返すという、やや魅力に欠ける作業手順となってしまいます。</p>
             <p>KH Coderの仕様においては、「関連があるテキストデータはすべて1つのファイル内にまとめられている」ことを前提にしています。したがってKH Coderで分析を行う前に、20個のファイルを<font color="red">適切な形で1つのファイルに結合</font>すれば良いのです。そうすれば、見違えるほど効率的な分析手順になるはずです。</p>
             <p>■2. ファイルの結合</p>
             <p>デスクトップ（またはその他の分かりやすい場所に）に新しいフォルダを作成して下さい。名前はなんでも構いません。そのフォルダの中に、自分が選んだ20個のテキストファイルをコピーします。</p>
             <p>KH Coderを起動してメニューから「ツール」「プラグイン」「データ準備」「テキストファイルの結合」を実行します。下図の画面が開くので、「フォルダ:」の箇所で先程のフォルダを指定します。「参照」ボタンをクリックして選んでも構いませんし、白い入力欄にフォルダをドラッグ＆ドロップしても構いません。</p>
            </div>
           </div>
           <div align="center">
            <p><img src="screen/cancat_txt.png" width="348" height="183" border="0"></p>
           </div>
           <p>フォルダを指定したら、その他のオプションは変更せずに「OK」をクリックします。すると「名前を付けて保存」画面が開くので、ファイル名を決めて下さい。これで結合は完了です。仮に「結合.txt」という名前で保存したとすると、同じ場所に「結合_names.txt」というファイルが別途保存されます。こちらのファイルも後で使います。</p>
           <p>以上の操作によって、フォルダ内のすべてのファイルが結合されました。それぞれのファイルの内容が始まる前には「&lt;h2&gt;file:ファイル名&lt;/h2&gt;」という見出しが付いています。この見出しがあるので、結合前の各ファイルの内容を、KH Coderは別個の「文書」として認識します。<font color="red">見出しのおかげで、1つのファイルに結合してしまっても、別々の「文書」として扱える</font>のです。より正確には、h2見出しで区切られているので、「h2単位の文書」と認識されます。</p>
           <p>■3. 結合したファイルの登録</p>
           <p>仮に「結合.txt」という名前で保存したとします。この「結合.txt」を新規プロジェクトの「分析対象ファイル」としてKH Coderに登録します。メニューから「プロジェクト」「新規」です。そして、メニューから「前処理」「分析対象ファイルのチェック」を行います。もし何か問題が見つかった場合は、自動修正の「実行」ボタンをクリックします。ここまでは通常のプロジェクトの登録と同じです。</p>
           <p>次に、メニューから「前処理」「語の取捨選択」画面を開きます。そして、「強制抽出する語の指定」「使用しない語の指定」の両方の入力欄に、「結合_names.txt」をドラッグ＆ドロップして下さい。下図のように、内容が貼り付けられたのを確認して「OK」をクリックします。<font color="red">この操作によって、見出し部分が語としてカウントされず、分析上は「無いもの」として扱われる</font>ようになります。</p>
          </div>
          <div align="center">
           <p><img src="screen/force_and_stop_words.png" width="543" height="389" border="0"></p>
          </div>
          <div align="left">
           <p>以上の設定を行ってから、メニューより「前処理」「前処理の実行」をして下さい。</p>
           <p>■4. 分析のための操作</p>
           <p>もともと20個のファイルに入っていた内容を、KH Coderは20個の「h2単位の文書」として認識しています。あとは、それぞれの文書の総語数・異なり語数を出せば、「練習問題」に取り組むことができます。 
           <p>各文書の総語数・異なり語数を出力する機能は、既製の機能としてはKH Coderに備わっていません。ですが、SQL文を入力すれば集計を行えます。メニューから「ツール」「SQL文の実行」をクリックします。画面上部のEntry欄に、以下のSQL文を貼り付けて、「実行」をクリックして下さい。</p>
          </div>
          <div align="center">
           <p><textarea name="textareaName" cols="60" rows="5" wrap="off">SELECT   h2_id,
         COUNT(*) as n_total,
         COUNT(DISTINCT genkei.id) as n_types
FROM     hyosobun, hyoso, genkei, khhinshi
WHERE
         hyosobun.hyoso_id = hyoso.id
     AND hyoso.genkei_id = genkei.id
     AND genkei.khhinshi_id = khhinshi.id
     AND khhinshi.name != &quot;HTMLタグ&quot;
     AND genkei.nouse = 0
GROUP BY hyosobun.h2_id, hyosobun.h1_id
ORDER BY hyosobun.h1_id, hyosobun.h2_id</textarea></p>
          </div>
          <div align="left">
           <p>以下のように結果が表示されます。「n_total」が総語数、「n_types」が異なり語数です。一番左の「h2_id」は文書のIDです。結合ファイルの1つ目の文書がID「1」、2つ目の文書がID「2」というふうに、結合ファイル内の順番でID番号が振られています。Result欄の結果を選択して「コピー」ボタンをクリックし、Excelに貼り付ければ、あとはExcel上での計算で目的を達成できます。</p>
          </div>
          <div align="center">
           <p><img src="screen/sql_total_types.png" width="464" height="721" border="0"></p>
          </div>
          <div align="left">
           <p class="gray_char">※KH Coderは形態素解析の結果をMySQLデータベースに格納しています。そのため、あらかじめ既製の機能として備わっていなくとも、SQL文を入力することで、様々な集計を行うことができます。もし、ご自身でSQL文を書いてみようとお考えの方は、KH Coderのリファレンスマニュアル4.2節でテーブル構造をご確認下さい。</p>
           <div align="right">
             <div align="right">
             <p><a href="#page-top">↑ Index ↑</a></p>
             <p></p>
            </div>
           </div>
           <div align="left">
            <h4><a name="c5st"></a>第5章の「日本語研究」（p. 132）</h4>
           </div>
           <div align="right">
            <div align="left">
             今回は30個のファイルの分析です。新しいフォルダを作って、当該の30個のファイルをその中にコピーしましょう。そして<a href="#c5prac">第5章の「練習問題」（p. 136）</a>と同様に<a href="#c5prac">、</a>「2. ファイルの結合」「3. 結合したファイルの登録」「4. 分析のための操作」を行います。その結果をExcelに貼り付けておいて下さい。後で、1000語あたりの調整頻度を求めるために、総語数（n_total）を使います。

             <p>次に、以下のSQLを実行することで、「主要品詞頻度表」を作成します。</p>
            </div>
           </div>
          </div>
          <div align="center">
           <p><textarea name="textareaName" cols="60" rows="5" wrap="off">
SELECT   h2_id,
         sum( if(hinshi.name = "名詞-形容動詞語幹"   , 1, 0) ) as 形容動詞,
         sum( if(hinshi.name = "形容詞-自立"         , 1, 0) ) as 形容詞,
         sum( if(hinshi.name = "副詞-一般"           , 1, 0) ) as 副詞,
         sum( if(hinshi.name = "助動詞"              , 1, 0) ) as 助動詞,
         sum( if(hinshi.name = "接続詞"              , 1, 0) ) as 接続詞,
         sum( if(hinshi.name = "連体詞"              , 1, 0) ) as 連体詞,
         sum( if(hinshi.name = "名詞-一般"           , 1, 0) ) as 名詞,
         sum( if(hinshi.name like "助詞%"            , 1, 0) ) as 助詞,
         sum( if(hinshi.name = "動詞-自立"           , 1, 0) ) as 動詞
FROM     hyosobun, hyoso, hinshi
WHERE
         hyosobun.hyoso_id = hyoso.id
    AND  hyoso.hinshi_id = hinshi.id
GROUP BY hyosobun.h2_id, hyosobun.h1_id
ORDER BY hyosobun.h1_id, hyosobun.h2_id
</textarea></p>
           <p><img src="screen/sql_hinshi_hindo.png" width="577" height="539" border="0"></p>
          </div>
          <div align="left">
           <p>表頭の品詞名がローマ字になっていますが、「主要品詞頻度表」が得られました。これをExcelに貼り付け、最初に求めた各文書の総語数で割ってから1000をかけると、p. 133の表2が得られます。あとはExcel上での統計分析で完了です。</p>
           <p><font color="gray">※書籍本文での「p_01」「p_02」といったファイルの番号付けと、CD-ROM内のファイル番号は一致していないようです。したがって、書籍本文と似た結果にはなりますが、まったく同じ分析結果は得られません。ちなみに、書籍本文での「p_02」がCD-ROM内の「cjejus_ptj_005」にあたるようです。こうした対応関係をすべて洗い出せば、書籍本文とまったく同じ分析結果を出すこともできるでしょう。</font></p>
           <div align="right">
             <div align="right">
               <div align="right">
              <p><a href="#page-top">↑ Index ↑</a></p>
             </div>
             </div>
           </div>
           <h4><a name="c6prac" id="c6prac"></a>第6章の「練習問題」（p. 161）</h4>
           <div align="left">
            <div align="left">
             <div align="right">
              <div align="left">
               <p>ここでは青空文庫から20作品をダウンロードして、以下のようなクリーニングを行いました。ファイルの冒頭と末尾に付いている説明・日付を削除しましたが、冒頭の作品タイトルと著者名は残しました。そして、テキストエディタ「秀丸」の正規表現を用いた置換機能で、以下の正規表現を空の文字列に置換しました。ルビ・注釈に加えて、見出しをインデントするための全角スペースを削除しています。</p>
              </div>
             </div>
             <div align="center">
              <table border="1" cellpadding="3" cellspacing="0">
               <tr>
                <td><tt>《.+?》|｜|［＃.+?］|^　{2,}</tt></td>
               </tr>
              </table>
             </div>
             <div align="right">
              <div align="left">
               <div align="left">
                <div align="right">
                 <div align="right">
                  <div align="left">
                   <p>その後、「〔」を検索して<a href="http://cosmoshouse.com/tools/acc-conv-j.htm">アクセント</a>の除去を個別に行いました。またアルファベット（<tt>[a-z,\.]</tt>）と日本語文字（<tt>[^\x01-\x7E]</tt>）の間に挿入されている半角スペースについても除去しました。以上でクリーニングは完了です。</p>
                  </div>
                 </div>
                </div>
               </div>
               <p>今回は20個のファイルの分析です。<a href="#c5prac">第5章の「練習問題」</a>の「2. ファイルの結合」「3. 結合したファイルの登録」と同じ手順を行います。この手順にそって、20個のファイルを1つのファイルに統合してKH Coderに登録します。</p>
               <p>ただし前処理を行う前に、メニューから「前処理」「語の取捨選択」画面を開き、下図(a)のように、強制抽出する語として「と、」「て、」「は、」「が、」「で、」「に、」「ら、」「も、」の8つを加えます。これによって「と、」や「て、」などが1つの語としてKH Coderに抽出されるようになるので、集計が簡単になります。なお、これらの語には「タグ」という品詞名があたえられます。この指定を行ってから、前処理を実行して下さい。</p>
              </div>
              <div align="center">
               <table border="0" align="center">
                <tr>
                 <td align="center" valign="middle"><img src="screen/c6prac_co.png" width="189" height="322" border="0"><span class="cnt"><br>
                   
                   (a) 語の取捨選択</span></td>
                 <td width="20">&nbsp;</td>
                 <td align="center">
                  <p><img src="screen/c6prac_coo.png" width="305" height="458" border="0"><span class="cnt"><br>
                    
                    (b) 「文書x抽出語」表の出力</span></p>
                 </td>
                </tr>
               </table>
              </div>
             </div>
             <div align="left">
              <p>次に「ツール」「文書」「『文書 x 抽出語』表の出力」「CSVファイル」をクリックします。そして上図(b)のように設定します。集計単位を「H2」にします。品詞は一度「クリア」をクリックしてから、「タグ」だけにチェックを入れます。以上の設定が終わればOKをクリックします。これによって<font color=red>下図に一部を示すような「文書x抽出語」表がCSV形式で保存されます</font>。CSV形式のファイルをダブルクリックすればExcel上に表が読み込まれます。</p>
             </div>
            </div>
            <div align="center">
             <p><img src="screen/c6prac_out.png" width="439" height="146" border="0"></p>
            </div>
            <p>「と、」「て、」「は、」などの粗頻度が記入されているので、F列のlength_w（総語数）で割ってから10,000をかけることで、1万語あたりの調整頻度を計算できます。あとはExcel上で解析を実行するだけです。</p>
            <p><font color="gray">※本当は練習問題では、分析前に各作品の冒頭の10,000字だけをファイルに保存することで、頻度の調整をするように指定されています。ですがこのページでは総語数で割ってから10,000をかけることで調整することにしました。後者の調整の方がより多くのデータにもとづいた正確な値になるはずなので、先生にもゆるしていただけるといいなぁと&hellip;。</font></p>
            <p><font color="gray">なお、上図に見えているO1〜O5、O10はそれぞれ順に鴎外の「あそび」「阿部一族」「寒山拾得」「ヰタ・セクスアリス」「牛鍋」「細木香以」です。</font></p>
            <div align="left">
             <div align="right">
              <div align="right">
               <p><a href="#page-top">↑ Index ↑</a></p>
              </div>
              <div align="left">
               <div align="left">
                <h4><a name="c6st" id="c6st"></a>第6章の「日本語実例研究」（p. 157）</h4>
                <div align="left">
                 <div align="left">
                  <div align="right">
                   <div align="left">
                    <p>ここでは一般公開されていないデータが使われているので、上の<a href="#c6prac">第6章の「練習問題」</a>と同じデータを使いつつ操作方法を紹介します。</p>
                    <p>まずは、「。」の直前にどんな語が多く出現しているのかを調べなくてはなりません。そのためには、次のような操作を行います。まず、メニューから「前処理」「語の取捨選択」を開きます。そして「品詞による語の選択」の箇所で、下から2番目にある「その他」にチェックを入れて「OK」をクリックします。次に、メニューから「ツール」「抽出語」「KWICコンコーダンス」を開き、「抽出語」欄に「。」と入力して検索します。KWICを目で見るのは無理があるので、「KWICコンコーダンス」の画面右下にある「集計」ボタンをクリックします。「コロケーション統計」画面が開くので、この画面の下の方で、「ソート」を「左1」に設定します。これによって下図のように、「。」の直前に多く出現する順に語が並びます。</p>
                   </div>
                   <div align="center">
                    <p><img src="screen/c6st_coloc.png" width="588" height="443" border="0"></p>
                   </div>
                   <div align="left">
                    <p>次は頻度の集計です。単に「ある。」という文字列を数えれば良い場合には、上の<a href="#c6prac">第6章の「練習問題」</a>と同様に、「ある。」や「いる。」の強制抽出を行えばそれで良いでしょう。しかし、「いる」という語の直後に「。」が続いているケースを数えたい場合、すなわち「いる」という語として抽出されているものだけを数えたい場合には、少し手順が変わります。後者の場合には次のようなSQL文を使うのが早道でしょう。</p>
                   </div>
                   <div align="center">
                    <p><textarea name="textareaName" cols="60" rows="5" wrap="off">SELECT   center.h2_id, count(*) as n_total,
         sum( if( genkei.name = &quot;ある&quot; and rh.name = &quot;。&quot;, 1, 0) ) as aru,
         sum( if( genkei.name = &quot;いる&quot; and rh.name = &quot;。&quot;, 1, 0) ) as iru,
         sum( if( genkei.name = &quot;する&quot; and rh.name = &quot;。&quot;, 1, 0) ) as suru,
         sum( if( genkei.name = &quot;れる&quot; and rh.name = &quot;。&quot;, 1, 0) ) as reru,
         sum( if( genkei.name = &quot;です&quot; and rh.name = &quot;。&quot;, 1, 0) ) as desu,
         sum( if( genkei.name = &quot;ます&quot; and rh.name = &quot;。&quot;, 1, 0) ) as masu,
         sum( if( genkei.name = &quot;う&quot; and rh.name = &quot;。&quot;, 1, 0) ) as u,
         sum( if( genkei.name = &quot;か&quot; and rh.name = &quot;。&quot;, 1, 0) ) as ka,
         sum( if( genkei.name = &quot;ね&quot; and rh.name = &quot;。&quot;, 1, 0) ) as ne,
         sum( if( genkei.name = &quot;ん&quot; and rh.name = &quot;。&quot;, 1, 0) ) as nn,
         sum( if( genkei.name = &quot;」&quot; and rh.name = &quot;。&quot;, 1, 0) ) as kagi,
         sum( if( genkei.name = &quot;）&quot; and rh.name = &quot;。&quot;, 1, 0) ) as kakko
FROM     khhinshi, genkei, hyoso as ch,hyoso as rh, hyosobun AS center
         LEFT JOIN hyosobun AS r1 ON ( center.id + 1 ) = r1.id
WHERE    center.hyoso_id = ch.id
     AND ch.genkei_id = genkei.id
     AND genkei.khhinshi_id = khhinshi.id
     AND khhinshi.name != &quot;HTMLタグ&quot;
     AND genkei.nouse = 0
     AND r1.hyoso_id = rh.id
GROUP BY center.h2_id, center.h1_id
ORDER BY center.h1_id, center.h2_id</textarea></p>
                   </div>
                  </div>
                  <div align="left">
                   <p>メニューから「ツール」「SQL文の実行」を開き、画面上部のEntry欄にSQL文を貼り付けて「実行」をクリックすると、下図のような結果が得られます。</p>
                  </div>
                  <div align="center">
                   <p><img src="screen/c6st_out.png" width="498" height="517" border="0"></p>
                  </div>
                  <div align="left">
                   <p>粗頻度が集計されているので、各文書の総語数（n_total）で割って10,000をかけることで、調整頻度を計算して下さい。あとはExcel上で解析を行えば完了です。なお、ここで例に示したのと異なる文末表現を集計したい場合には、SQL文の「SELECT」付近で、&quot;ある&quot;や&quot;いる&quot;のように指定している箇所を変更すればOKです。</p>
                  </div>
                 </div>
                </div>
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
          <div align="right">
           <p><a href="#page-top">↑ Index ↑</a></p>
          </div>
          <div align="left">
           <h4><a name="c7prac" id="c7prac"></a>第7章の「練習問題」（p. 192）</h4>
           <div align="left">
            <div align="right">
             <div align="left">
              <p>今回は25個のファイルの分析です。<a href="#c5prac">第5章の「練習問題」</a>の「2. ファイルの結合」「3. 結合したファイルの登録」と同じ手順を行います。この手順にそって、25個のファイルを1つのファイルに統合してKH Coderに登録し、前処理を行います。</p>
              <p>次にメニューから「ツール」「抽出語」「抽出語リスト」をクリックすると、下図(a)のような表を確認できます。(a)抽出語リストを見ると、出現頻度が7以上の名詞を取り出せば、練習問題で指定された15語を取り出せることがわかります。「感覚」「人生」という余分な2語も付いてきてしまいますが、あとで削除すれば良いでしょう。</p>
              <table border="0" align="center">
               <tr>
                <td align="center" valign="middle"><span class="cnt"><img src="screen/c7prac_wl.png" width="177" height="361" style="text-align: center;"><br>
                  
                       (a) 抽出語リスト<br>
                 </span></td>
                <td width="20">&nbsp;</td>
                <td align="center">
                 <p><img src="screen/c7prac_co.png" width="305" height="458"><span class="cnt"><br>
                   
                       (b) 「文書x抽出語」表の出力</span></p>
                </td>
               </tr>
              </table>
              <p>そこでKH Coderのメニューから、「ツール」「文書」「『文書 x 抽出語』表の出力」「CSVファイル」をクリックします。そして上図(b)のように設定します。集計単位を「H2」、最小出現数を「7」に。品詞は一度「クリア」をクリックして、名詞だけにチェックを入れます。以上の設定が終わればOKをクリックします。これによって<font color=red>下のような「文書x抽出語」表がCSV形式で保存されます</font>。CSV形式のファイルをダブルクリックすればExcel上に表が読み込まれます。</p>
              <p class="cnt"><img src="screen/c7prac_out.png" width="579" height="253" class="cnt"></p>
              <p>F列の「length_w」は各文書の総語数です。G列から右に、各文書に含まれた語数（粗頻度）が記入されています。この練習問題では、A〜F列までは不要なので削除すると良いでしょう。また右端に余分な2語「感覚」「人生」が付いているので、その2列も削除しましょう。あとはExcel上での計算で、練習問題は完了です。</p>
              <div align="right">
               <div align="right">
                <div align="right">
                 <p><a href="#page-top">↑ Index ↑</a></p>
                </div>
               </div>
              </div>
              <h4><a name="c7st" id="c7st"></a>第7章の「日本語実例研究」（p. 186）</h4>
              <div align="left">
               <div align="right">
                <div align="left">
                 上の<a href="#c7prac">第7章の「練習問題」</a>で保存した「文書x抽出語」表をそのまま利用します。手順の違いは、この表をExcel上でどう扱うかということだけです。F列の「length_w」は各文書の総語数なので、これで粗頻度を割ってから100をかけることで、「100語あたりの調整頻度」を作成します。あとはクラスター分析を実行するだけです。</div>
               </div>
              </div>
             </div>
            </div>
           </div>
           <div align="right">
            <div align="right">
             <div align="right">
              <p><a href="#page-top">↑ Index ↑</a></p>
              <p></p>
              <div align="left">
               <div align="left">
                <div align="left">
                 <div align="right">
                  <div align="left">
                   <h4><a name="c8prac" id="c8prac"></a>第8章の「練習問題」（p. 216）</h4>
                  </div>
                 </div>
                </div>
               </div>
               <p>まず準備として、kh_coder.exeと同じ場所にある「config」フォルダ内の「hinshi_chasen」というファイルを、「秀丸」などのテキストエディタで開きます。そして、次の1行をこのファイルに付け加えて、上書き保存します。これによって、KH Coderの品詞設定が変更され、「助詞」を分析対象として扱うようになります。（参考： <a href="FAQ.html#hinshi">KH Coderの品詞設定</a>）
</p>
              </div>
              <div align="center">
               <table border="1" cellpadding="3" cellspacing="0">
                <tr>
                 <td><tt>25,助詞,助詞</tt></td>
                </tr>
               </table>
              </div>
              <div align="left">
               <p>青空文庫から取得した15個のテキストファイルは、表9（p. 211）のコードに合わせて「A1.txt」「A2.txt」というふうに名前を付けておくと、後で分かりやすいでしょう。ファイル内容のクリーニングは、<a href="#c6prac">第6章の「練習問題」</a>と同じように行いました。</p>
              </div>
             </div>
             <div align="left">
              
             </div>
             <div align="right">
              <div align="left">
               <p>さて、今回は15個のファイルの分析です。<a href="#c5prac">第5章の「練習問題」</a>の「2. ファイルの結合」「3. 結合したファイルの登録」と同じ手順を行います。この手順にそって、15個のファイルを1つのファイルに統合してKH Coderに登録し、前処理を行います。</p>
               <p>次にメニューから「ツール」「抽出語」「抽出語リスト」をクリックすると、下図(a)のような表を確認できます。(a)抽出語リストを見ると、出現頻度が10,000以上の助詞を取り出せば、練習問題で指定された6語を取り出せることがわかります。</p>
              </div>
              <div align="center">
               <table border="0" align="center">
                <tr>
                 <td align="center" valign="middle"><span class="cnt"><img src="screen/c8prac_wl.png" width="173" height="182" border="0"><br>
                   
                   
                   (a) 抽出語リスト</span></td>
                 <td width="20">&nbsp;</td>
                 <td align="center">
                  <p><span class="cnt"><img src="screen/c8prac_co.png" width="305" height="458" border="0"><br>
                    
                    
                    (b) 「文書x抽出語」表の出力</span></p>
                 </td>
                </tr>
               </table>
              </div>
             </div>
             <div align="left">
              <p></p>
              <p>そこでKH Coderのメニューから、「ツール」「文書」「『文書 x 抽出語』表の出力」「CSVファイル」をクリックします。そして上図(b)のように設定します。集計単位を「H2」、最小出現数を「10000」に。品詞は一度「クリア」をクリックして、助詞だけにチェックを入れます。以上の設定が終わればOKをクリックします。これによって<font color=red>下のような「文書x抽出語」表がCSV形式で保存されます</font>。CSV形式のファイルをダブルクリックすればExcel上に表が読み込まれます。</p>
             </div>
            </div>
            <div align="center">
             <p><img src="screen/c8prac_out.png" width="543" height="305" border="0"></p>
            </div>
           </div>
           <div align="left">
            <p>6つの助詞の粗頻度が記入されているので、F列のlength_w（総語数）で割ってから100,000をかけることで、「10万語あたりの調整頻度」を計算できます。あとはExcel上で解析を実行するだけです。</p>
            <p><font color="gray">※10万語あたりの調整頻度を計算すると、書籍のCD-ROMに同梱の「正解ファイル」と、少しズレのある数値になります。上図と表9を見比べれば分かるように、これは各ファイルの総語数に違いがあるためです。おそらく、青空文庫から入手したファイルのクリーニング方法に違いがあったのでしょう。</font></p>
           </div>
           <div align="right">
            <div align="right">
             <div align="right">
              <div align="left">
               <div align="right">
                <div align="right">
                 <div align="right">
                  <p><a href="#page-top">↑ Index ↑</a></p>
                 </div>
                 <div align="left">
                  <div align="left">
                   <div align="left">
                    <div align="right">
                     <div align="left">
                      <h4><a name="c8st" id="c8st"></a>第8章の「日本語実例研究」（p. 212）</h4>
                                            上の<a href="#n8prac">第8章の「練習問題」</a>で作成したKH Coderのプロジェクトをそのまま利用して、「文書x抽出語」表の出力だけをやり直します。

                      <p>KH Coderのメニューから「ツール」「文書」「『文書 x 抽出語』表の出力」「CSVファイル」をクリックします。集計単位を「H2」、最小出現数を「1」に。品詞は一度「クリア」をクリックして、副詞と副詞Bの2つだけにチェックを入れます。以上の設定が終わればOKをクリックします。</p>
                      <p>これで800種類ほどの副詞を含む「文書x抽出語」表が出力されます。書籍本文と同様に分析するためには、Excel上で「少し」と「すこし」を足し併せたり、上位100だけにしぼって残りを削除したりといった整理を行います。あとは練習問題と同じように、10万語あたりの調整頻度を計算して、解析を実行するだけです。</p>
                     </div>
                     <div align="right">
                      <p><a href="#page-top">↑ Index ↑</a></p>
                     </div>
                     <div align="left">
                      <h4><a name="c10" id="c10"></a>第10章の「日本語実例研究」（p. 260）</h4>
                                            まず<a href="http://www.kantei.go.jp/">官邸のWeb</a>からデータ収集ですが、所信表明演説の本文を「橋本_1.txt」「橋本_2.txt」といったファイルに個別に保存し、タイトルや見出しなど余分なものを削除します。橋本首相から麻生首相までの所信表明演説を集めると18ありますが、書籍本文ではそのうち13を選んで分析しているようです。さてどうしようかと思ったのですが、このページでは試みに18回すべてを分析して、同じような結果が出るかどうか眺めてみることにします。

                                            <p>ここまで分析を進めてこられた方にはもはや明らかだと思いますが、あとはおなじみの手順です。<a href="#c5prac">第5章の「練習問題」</a>の「2. ファイルの結合」「3. 結合したファイルの登録」と同じ手順を行います。この手順にそって、18個のファイルを1つのファイルに統合してKH Coderに登録し、前処理を行います。</p>
                      <p>次は「文書x抽出語」表の出力です。KH Coderのメニューから「ツール」「文書」「『文書 x 抽出語』表の出力」「CSVファイル」をクリックします。そして次のように設定します。</p>
                      <ul>
                       <li>集計単位を「H2」に

                       <li>最小出現数を「5」に

                       <li>品詞は一度「クリア」をクリックしてから、名詞・サ変名詞・固有名詞・組織名・人名だけにチェック

                      </ul>
                      <p>この設定で738種類の名詞の頻度表、すなわち<font color="red">「文書x抽出語」表</font>が出力されます。この表の一部を下図に示します。</p>
                     </div>
                     <div align="center">
                      <p><img src="screen/c10out.png" width="415" height="126" border="0"></p>
                     </div>
                     <div align="left">
                      <p>あとは、この表を使ってExcel上で対応分析を行うだけです。なお、書籍本文の名詞頻度表（表9）と比べると、行と列が逆になっています。Excel上で行と列の入れ替えを行って下さい。首相の並んでいる順序や名詞の順序も違いますが、この点は分析結果になんら影響しないので、気にしないことにしましょう。</p>
                      <p>ここから先は余談ですが、対応分析についてはKH Coder上でも実施できます。ただしデフォルトの状態では、画面が700種類の名詞で真っ黒に埋まっています。そこでWindow左下の「表示」部分で「変数のみ」を選択すると、下図のような結果が得られます（ver. 2b.25以降で追加のオプション）。なお下図の例では、分析対象ファイル内の「&lt;h2&gt;file:小泉_1.txt&lt;/h2&gt;」のような見出しを、「&lt;h2&gt;小泉_1&lt;/h2&gt;」のように簡略化しています。</p>
                     </div>
                     <div align="center">
                      <p><a href="screen/c10corresp_full.png"><img src="screen/c10corresp_x.png" width="335" height="247" border="1"></a></p>
                     </div>
                     <div align="left">
                      <p>書籍本文における分析結果と同様に、回を重ねるごとに小泉首相の演説内容が、橋本・小渕・森らの従来グループから距離をとっていくことが分かります。また、(1)橋本・小渕・森らの従来グループ、(2)小泉、(3)阿部・福田・麻生らのポスト小泉グループという3つに別れる点も、書籍本文の分析結果と共通しています。<font color="gray">※書籍の図6（p. 261）と比べるとX軸の正負（左右）が反転しているように見えますが、対応分析では軸の反転はまま見られることですし、反転しても上のような解釈ができることに変わりありません。</font></p>
                     </div>
                     <div align="right">
                      <p><a href="#page-top">↑ Index ↑</a></p>
                     </div>
                    </div>
                   </div>
                  </div>
                 </div>
                </div>
               </div>
              </div>
             </div>
            </div>
           </div>
          </div>
         </td>
        </tr>
       </table>
       <div align="right"><br>
       </div>
       <div align="right">
         <table width="638" border="0" cellspacing="0" cellpadding="0" height="27">
           <tr>
             <td width="12" bgcolor="white"><img src="img/databg2.gif" width="17" height="35" align="BOTTOM" border="0" naturalsizeflag="3"></td>
             <td bgcolor="#00006c" background="img/databg.gif" width="626"><span class="ph">おわりに</span></td>
           </tr>
         </table>
         <br>
         <table border="0" cellpadding="0" cellspacing="0" width="97%">
           <tr>
             <td><h4><a name="owari" id="owari"></a>別解を振り返って</h4>
               <p>■SQL文について</p>
               <p>以上、9つの分析について、反復操作なしに処理を行う別解を作成してきました。そのうち6つまでは、マウス操作で既製のKH Coderの機能を利用するだけで完了しましたが、残り3つではSQL文を実行する必要がありました。このSQL文ですが、現時点では内容を理解する必要はありません。例えば、「このSQL文を貼り付けて実行するのが、『総語数と異なり語数の計算』ボタンを押すのと同じ意味になるらしい」という理解で、現時点では十分です。将来「似ているけど、少し違う集計をしたい」「そのためにはSQL文をどう修正すればよいのだろう」といった目的が生じたならば、その時点でSQL文の内容を見て、一部修正＆実行を試みると良いでしょう。その際にはSQL構文やMySQLデータベースの参考書の他、本Webサイトの掲示板をご利用下さい。</p>
               <p>■感想 </p>
               <p>このページでは、「練習問題」と「実例研究」のうちKH Coderで行うとされているもの、それも10回以上の反復作業を含むものだけを取り上げました。それだけでも以上の9つの分析がありました。これらの分析を手元で実際に行ってみる中で、小説・演説・作文など、種類が異なるデータの収集・準備・分析に触れることができ、大変勉強をさせていただきました。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=khcoder-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=487424498X" style="width:120px;height:240px; margin:5px 20px 20px 5px; " scrolling="no" marginwidth="0" marginheight="0" frameborder="0" align="left"></iframe>


               <p>以上に取り上げた課題以外にも、「練習問題」と「実例研究」はたくさんあります。さらに、このページではまったく手を付けていない「発展研究のヒント」もあります。『<a href="http://www.amazon.co.jp/gp/product/487424498X/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=487424498X&linkCode=as2&tag=khcoder-22">言語研究のための統計入門</a>』には、「おもしろそうだな、やってみようか」と思わせる分析の課題、しかもデータやソフトが付属していて実際にやってみることができる課題が、本当に数多くちりばめられているのです。読者の持つ気力と時間次第で、いくらでも課題にチャレンジできますし、その中では「もっとこうすればおもしろいんじゃないか」という読者独自の課題もひらめくことでしょう。このページの冒頭でも触れましたが、そうした試みの中でこそ力がつくものと思いますし、門外漢ではありますが、あらためて素晴らしい入門書であるとの思いを強くしました。 </p>
               <div align="right">
                 <p><a href="#page-top">&uarr; Index &uarr;</a></p>
                 </div>
               <div align="right"> </div></td>
             </tr>
         </table>
       </div>
       <div align="right">
         <p></p>
       </div>
      </div>
      <div align="right">
       <csobj w="643" h="97" t="Component" csref="../khc.data/Components/foot.html" occur="56">
        <div align="center">
         <table border="0" cellpadding="5" cellspacing="2" style="border: 1px dashed gray;">
          <tr>
           <td nowrap valign="middle">
            <div align="left">
             <p><span class="t12">Hosted by <b>GitHub</b></p>
            </div>
           </td>
           <td nowrap>&nbsp;&nbsp;<span style="font-size:16pt">＊</span>&nbsp;&nbsp;</td>
           <td nowrap><span class="t12">Copyright &copy; 2001-<script type="text/javascript" language="JavaScript"><!--
TYnow = new Date();document.write( TYnow.getFullYear() );
// --></script> <a href="http://koichi.nihon.to/psnl">樋口耕一</a></span><br>
            <span class="t12">E-Mail: <script type="text/javascript" language="javascript"> var s="c`nmtxOc`XoDxc`Xsvxc`Xspxc`Xsuxc`Xsvxc`sqxSc`nnrxc`qsxRITSUMc`XsrxIc`"+ "XoExc`Xsnxc`Xspxkc`XsAxc`Xtmx",r=""; for(i=0;i<s.length;i++)r+=String.fromCharCode((s.charCodeAt(i)-1)%93+33); document.write('<a href="mailto:'+r+'">'+r+'</a>') </script> <noscript> ［JavaScriptを有効にするとアドレスが表示されます］ </noscript> </span></td>
          </tr>
         </table>
        </div>
       </csobj></div>
     </td>
		</tr>
	</table>
  </div>

<script type="text/javascript" language="JavaScript">
<!--
var pa = "http://koichi.nihon.to/cgi-bin/ds/dsw.cgi";
var pg = "KHC-KURO";
var p = "n";
var cnt = "";
var a="&&"; var pf=navigator.platform; var lng=navigator.language; var swh=screen.width+"x"+screen.height; var cd=screen.colorDepth; var pd=screen.pixelDepth; var rf=document.referrer; document.write("<img src='"+pa+"?xx=",new Date().getSeconds(),a+"cnt="+cnt+a+"p="+p+a+"md=j"+a+"pg="+pg+a+"pf="+pf+a+"lng="+lng+a+"swh="+swh+a+"cd="+cd+a+"pd="+pd+a+"rf="+rf+"' alt='' border='0' />")
// -->
</script>
<noscript>
<img src="http://koichi.nihon.to/cgi-bin/ds/dsw.cgi?md=nj&&p=n&&pg=KHC-KURO" alt="" border="0" />
</noscript>


 </body>



</html>
	