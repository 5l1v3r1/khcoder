[[メモ]]

[KH Coderに起因する制限]
・<h1>〜<h5>で括る見出しの長さは全角4000字が限度
・語の長さは全角126文字まで

[Windows版の茶筌2.03b9に起因する制限]
・文字化け部分があると、その行に関するChaSenの解析結果がおかしくなることがある
　見出し部分では、HTMLタグが消失する場合があり、致命的（→整合性エラー）
・あまりに長い段落があると、ChaSenの出力がおかしくなることがある
　全角8000字程度が限度か

[GUI / Documentationの無い機能]
	・Ctrl + Hで品詞別の頻度などを段落単位で集計・出力
		（強制抽出無し、HTMLタグ無視。大隅先生向け）

[All in Oneパッケージ作成時の注意]
	・MySQLの「root@gcw」ユーザーを削除しておくこと

[Tk 804.xx対応について]
	・日本語表示のための置換（秀丸の正規表現）
		From: Jcode->new\(\f.*\f\)->sjis
		To:   $self->gui_jchar(\1)
	・getSaveFile / getOpenFileの手当てが必要・・・（日本語ファイル名対策）

[Anonymous CVSのコマンド]
	cvs -d:pserver:anonymous@cvs.sf.net:/cvsroot/khc checkout core
	cd core
	perl kh_coder.pl
	
	EXPORTの場合：
	cvs -d:pserver:anonymous@cvs.sf.net:/cvsroot/khc export -r HEAD core


[TO DO]
	・コロケーション統計の追加（KWIC）
	・tf/idf順の復活（文書検索）
	・連関規則の計算時に欠損値処理を行う (?)
	・品詞体系： 「連体詞」の処理 (?)
	・データファイルの先頭に改行があると前処理がエラーになるバグの修正
	・コード集計時にχ２乗検定を
	・EUC/S-JIS/JISなど各種文字コードでの入力に対応

[2.b.2での改良点]
	・文書表示Window（コンコーダンス・文書検索）に表示される情報を追加
		現在表示している文書の位置情報・外部変数情報を表示するようにした
	・コンコーダンス（KWIC）機能の改善
		・改行があってもそのままつなげて表示していたのを改め、改行を「（↓）」という記号で表示するようにした（ただし段落間の区切りのみ）
		・コロケーション統計の追加
		・「左右（前後）に特定の語が出現していること」という条件を追加し、結果を絞り込めるようになった。
		・コンコーダンス作成時に前後30語までしか取り出せないという制限を排除
			ただし、広い範囲を確認したい場合には、各ラインをダブルクリックして文書表示Windowを開くことを推奨。コンコーダンス作成時に前後100語を取り出すといったことも可能にはなったが、実際の確認はおそらく難しいので…。
	・設定Windowでフォントを変更できるようになった
	・カイ2乗検定を追加（要R）
		「コーディング」→「章・節・段落ごとの集計」
		「コーディング」→「外部変数とのクロス集計」
		Rがデフォルトのパスにインストールされている場合、Rを用いてピアソンのカイ2乗検定を行うようにした
	・分析対象ファイルやコーディングルール・ファイルの制限を若干緩和した。
		データ中に半角カナが含まれていた場合、全角に変換してから処理することで、エラーを回避するよう修正。また、文字コード・改行コードの制限をなくしたので、Windows <-> Linux間で同じファイルを（変換無しに）分析に使えるようになった。ただし、内部ではEUCコードに変換して処理しているので、EUCに変換できないUnicode文字の使用は不可。
	・コーディング処理を少し効率化（高速化）した
	・各Windowを開く処理を少し効率化した（「もっさり」感をやや軽減）
	・MySQLを2重・3重に起動してしまう場合がある問題を修正（KH Coderを強制終了し、もう一度起動した場合等）[Windows版パッケージのみ]
	・Windows Vista beta 1に対応（たぶん）[Windows版パッケージのみ]

[2.b.1での改良点]
	・「コーディング」→「外部変数とのクロス集計」機能を改善
		これまでは、コーディング単位と同じ単位に読み込まれた外部変数だけしか、クロス集計に用いることができなかった。この点を改善して、コーディング単位よりも上位に読み込まれた外部変数を利用できるようにした。
	・All In Oneパッケージ作成のための修正
		・config\coder.iniファイルのsql_username, sql_password, sql_host, sql_portを書き換えれば、リモートマシン上のMySQLサーバーを利用することができるようになった
		・エラーを出して異常終了する際にも、終了処理ルーチンが動くように修正
		・その他細々とした修正
	・コーディングルール内で、「<＊コード名>」という指定によって、存在しないコードを再利用しようとした場合の挙動を修正。これまではPerlエラーが出ていたので、適切なエラーメッセージが出るように修正した。W
	・プロジェクト削除時に、MySQL内の関連データを抹消するように変更
	これまではMySQLサーバーに関連データが残っていた
	・キーバインド追加
	・プログラミング上の変更
		・NKF.pmを「必須」から「オプション」扱いに変更
		・Perl 5.8（Tk 804.xx）への対応作業を開始（…まだ未完了）

[2.a.6での改良点]
	・「HTMLからCSVに変換」コマンドのバグを修正
	・データ中に半角の数字があると前処理に失敗する場合があるバグを修正
	・前処理時に全角127文字を越える語が見つかった場合の挙動を変更
		これまではMySQLエラーが出るようになっていたので、それなりのエラー・メッセージが出るように修正
	・コーディング機能の改善
		・外部変数の扱いを改善
			これまでは検索やコーディングを行う単位と、同じ単位に読み込んだ外部変数しか用いることができなった点を改善した。例えばH2単位に読み込んだ外部変数を、H3単位、H4単位、H5単位、段落単位、文単位での検索やコーディングに用いることができるようになった。ただし、より上位の単位（この例ではH1単位）の検索・コーディングには使用できない。
		・30以上のコードを1つのコーディングルール・ファイル内に記述できるようになった
			・単純集計
			・章・節・段落ごとの集計
			・コーディング結果の出力
			・文書検索「＃コード無し」
			・抽出語連関規則「＃コード無し」

[2.a.5での改良点]
	・外部変数の読み込み機能を改善
		・タブ区切りファイルの読み込みに対応
		・値の中に「,」等を含むCSVファイルの読み込みに対応
	・文書表示Windowのバグを修正
		・文書表示の際に、語順がみだれ、解読不能になってしまう場合があるバグを修正
	・英語・仏語データの分析に（無理矢理）対応（?）
		・半角クォートがデータ中に含まれると前処理が失敗する場合がある問題を修正
		・半角クォートが含まれる語のコンコーダンス作成に失敗する問題を修正
		・半角クォートが含まれる語を用いた文書検索・コーディングに失敗する問題を修正
		・「強制抽出する語」または「使用しない語」として半角クォートが含まれる語を指定するとエラーが出る問題を修正
		・抽出語検索Windowで半角クォートを検索欄に入力するとエラーが出る問題を修正

[2.a.3での改良点]
	・データ出力の形式として、今までのCSVとSPSSに加えて、タブ区切りにも対応
	・品詞体系の変更
		茶筌が「形容詞-非自立」に分類した語を、KH Coderでも「形容詞（非自立）」という独立した品詞に分類することにした。これまではKH Coder上では「形容詞」または「形容詞B」に分類していた。
	・「『抽出語x文脈ベクトル』表の出力」コマンドの挙動を変更
		これまでは小数点以下8桁にまるめて出力していたが、そのまま出力するように変更した。（最大で小数点以下15桁まで出力されるようになった）
	・プロジェクトの削除に失敗する場合があるバグを修正
		分析対象として登録したファイルの名前（フルパス）に全角文字が含まれていると、そのプロジェクトを削除できなかった。
	・「Please Wait」Windowの位置を変更した
		完了ダイアログWindowが出ても、「Please Wait」Windowの下に隠れてしまう場合がある問題への対処
	・設定の初期化方法を変更
		KH Coderのアップデート対策

[2.a.2での改良点]
	・「文書x抽出語」表の出力が不正確になる場合があるバグの修正
		MySQLのバージョンに依存する問題???　今回のフィックスで3.23.58では正常動作することを確認。
	・「HTMLからCSVに変換」コマンドの出力結果が不正確になる場合があるバグの修正
		1行（1ケース）とする単位に、「文」を選択すると、出力結果が不正なものとなっていた
	・前処理でエラーが出る場合があるバグの修正
		分析対象ファイルに「読み取り専用」属性がついていた場合、2度目以降の前処理がエラーとなっていた
	・Excel用アドインの修正
		「頻出150語の表を作成」時に、否定助動詞も無視するように変更
	・マニュアルの改訂
		p.9〜p.11に「否定助動詞」についての記述を追加した

[1.x → 2.a.1での改良点]

	[全般]
		・WindowsだけでなくLinuxにも対応した
		・各Windowの位置とサイズを記憶するようになった
		・前処理時や各種ツール使用時に、いちいち「集計単位」を指定しなくても良くなった
		・プロジェクトごとに、最後に利用した検索やコーディングの単位と、コーディングルールファイルを記憶するようになった
		・外部アプリケーション（SPSSやIE/Netscape）への依存が減少した
		・再起動しなくても、複数のプロジェクトを切り替えられるようになった
		・全てのWindowに共通のキー・バインドを追加
			→ ESCキーでWindowを閉じる
			→ 左AltキーでMain Windowをアクティブに
		・ソースコードのトレースが容易になった
			→オブジェクト指向プログラミングをより広範に取り入れた
			→インターフェイス部分とロジック部分を極力分離した

	[前処理関係]
		・前処理に必要な処理時間が大幅に減少した
		・元の文からどのように語を抽出したかの確認（検索）が容易に
		・無視したい語（stop word）、無視したい品詞の指定がより容易になった
		・品詞体系そのものをより容易に変更できるようになった
		・前処理完了をメールで通知できるようになった（リモート操作向け）

	[コーディング関係]
		・「先頭から数えて何番目の文書か」を利用してコーディング可能に
			「統計ソフトで行ったクラスター分析の結果、？番目の文書が特徴的だとわかった」といった場合に、容易に検索（コーディング）できる
		・（抽出語の）特定の活用形が含まれる文書をコーディング可能に
			例えば、「『死ぬ』という語の未然形が含まれる文書をコーディングする」など。
		・抽出語ではなく、特定の"文字列"が含まれている文書をコーディング可能に
			設計思想からすると多用すべき機能ではないが、用いると便利なケースも希にある。
		・上位見出しだけでなく同位の見出しを使ったコーディングが可能に
		・集計機能 -- 外部変数とのクロス集計が可能に
		・フレーズ検索が可能に

	[ツール関係]
		・コンコーダンス機能を追加
			特定の一語が文書中でいかに使われているかを調べる際には、「文書検索」よりも便利
		・抽出語検索の機能向上
			-> 部分・完全・前方・後方一致検索が可能に
			-> 活用形を表示可能に
			-> コンコーダンス機能との接続
		・文書検索の機能向上
			-> 検索結果を200づつに区切って表示するように
				数千もの文書が一気に表示されると、時間がかかるだけでなく、閲覧も難しい
			-> コーディング・ルールを直接Windowに打ち込めるようになった
				いちいちコーディングルール・ファイルを作製・保存しなくても、容易に高度な検索が行うことができる。「ちょっと試してみたい」時には便利
			-> ルールファイル中のコードと直接入力をAND/ORで組み合わせられるように
				コーディングルール・ファイルから読み込んだルールに、条件を追加して検索するといったことが容易に。
			-> 文書表示時の語の強調（色づけ）が正確になった
		・抽出語-連関規則の機能向上
			-> 確立差・確立比に加えて、Jaccard、Ochiai、chi-squareが利用可能に
			   （ただしchi-squareは無修正）
		・「文脈ベクトル」を出力する機能を追加
		・SQL文入力による自由な検索が可能に
			SQL文を入力すれば、もともと用意されている検索だけでなく、分析者の思いつく限り、ありとあらゆる検索・計算を行うことができる
		・外部変数の使い勝手を向上
			・1.xでは数値型しか扱えなかったが、値に文字列を投入することも可能になった
			・1.xでは前処理を再度行った場合、外部変数も再度読み込む必要があったが、この必要が無くなった
			・外部変数として読み込まなくても、見出しをコーディングに利用できるようになった

[1.xからカットした機能]
	・JUMANへの対応
	・tf-idf値の出力
